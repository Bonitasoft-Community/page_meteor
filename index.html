<!doctype html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Meteor</title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="style/animate.css" />
<link rel="stylesheet" href="style/bootstrap.min.css">
<link rel="stylesheet" href="style/main.css">
<link rel="stylesheet" href="style/style.css">
<link rel="stylesheet" href="style/dropbox.css">
<link rel="stylesheet" href="style/ng-modal.css">



<!-- 
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript"
	src="https://www.google.com/uds/?file=visualization&amp;v=1&amp;hl=fr&amp;packages=corechart&amp;async=2"></script>
<link type="text/css" href="https://www.google.com/uds/api/visualization/1.0/ff67c3772da186a412ae3231c32409e9/ui+fr.css"
	rel="stylesheet">
<script type="text/javascript"
	src="https://www.google.com/uds/api/visualization/1.0/ff67c3772da186a412ae3231c32409e9/format+fr,default+fr,ui+fr,corechart+fr.I.js"></script>
<link href="https://ajax.googleapis.com/ajax/static/modules/gviz/1.0/core/tooltip.css" rel="stylesheet" type="text/css">
 -->
 
<style>
.Loading {
	display: inline-block;
	vertical-align: middle;
	background-position: center;
	background: no-repeat;
	background-image:
		url('data:image/gif;base64,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');
	width: 20px;
	height: 20px;
	margin-top: 6px;
	margin-right: 7px;
}
</style>
</head>


<!--  Page Directory: @_PAGEDIRECTORY_@ -->


<body ng-app="meteormonitor">
	<div class="bs-component" ng-controller="TitleController as titlectrl">
		<center>
			<table>
				<tr>
					<td><h1>Meteor</h1></td>
					<td rowspan="2"><img src="img/meteor.jpg" width="150"
						heigth="150" /></td>
				</tr>
				<tr>
					<td style="font-size: 0.8em">V4.0.0 Dec 21 2020</a></td>
				</tr>
				</div>
			</table>
		</center>
	</div>

<div class="container-fluid" id="accordion" ng-controller="MeteorControler as ctrl">


  
	<!--  ************************************************************  -->	
	<!--  Navigation        	 										-->
	<!--  ************************************************************  -->		  
	<ul class="nav nav-tabs"  ng-class="{'nav-stacked': vertical, 'nav-justified': justified}" style="border-bottom: 1px solid #c2c2c2;">
		<li ng-class="{active: active, disabled: false}" id="form-tab" heading="properties" active="true" title="Experience scenarii" select="ctrl.navbaractiv == 'experiencescenarii'" class="{{ctrl.getNavClass('experiencescenarii')}}" style="{{ctrl.getNavStyle('experiencescenarii')}}">
			  <a ng-click="ctrl.navbaractiv = 'experiencescenarii';"   class="ng-binding">Experience scenarii</a>
		</li>
		<li ng-class="{active: active, disabled: false}" id="form-tab" heading="context" active="true" title="Process scenarii" select="ctrl.navbaractiv == 'processscenarii'" class="{{ctrl.getNavClass('processscenarii')}}" style="{{ctrl.getNavStyle('processscenarii')}}">
			  <a  ng-click="ctrl.navbaractiv='processscenarii'"  class="ng-binding">Process Scenarii</a>
		</li>
		<li ng-class="{active: active, disabled: false}" id="form-tab" heading="analysis" active="true" title="Execution" select="ctrl.navbaractiv == 'execution'" class="{{ctrl.getNavClass('execution')}}" style="{{ctrl.getNavStyle('execution')}}">
			  <a  ng-click="ctrl.navbaractiv='execution'" class="ng-binding">Execution</a>
		</li>
		<li ng-class="{active: active, disabled: false}" id="form-tab" heading="unittest" active="true" title="Unit Test" select="ctrl.navbaractiv == 'unittest'" class="{{ctrl.getNavClass('unittest')}}" style="{{ctrl.getNavStyle('unittest')}}">
			  <a  ng-click="ctrl.navbaractiv='unittest'" class="ng-binding">Unit test</a>
		</li>
		<li ng-class="{active: active, disabled: false}" id="form-tab" heading="differentiel" active="true" title="Save" select="ctrl.navbaractiv == 'save'" class="{{ctrl.getNavClass('save')}}" style="{{ctrl.getNavStyle('save')}}">
			  <a  ng-click="ctrl.navbaractiv='save'" class="ng-binding">Load/Save</a>
		</li>
	</ul>

	<!--  ************************************************************  -->	
	<!--  Experience        	 										-->
	<!--  ************************************************************  -->		
	<div class="col-xs-12" ng-if="ctrl.navbaractiv == 'experiencescenarii'">
		<p>
		<h2>Scenario {{ctrl.config.name}}</h2>
		<p>
		<div ng-if="ctrl.deploimentsuc.length >0 " class="alert alert-success">
			{{ctrl.deploimentsuc}}
		</div>
		
		<input type="checkbox" ng-model="ctrl.experience.enable" title="Enable Experience">Enable Experience scenarii<p>
		
		<table><tr>
			<td>Case Id<input ng-model="ctrl.experience.listCasesId"  placeholder="1000,1003,1005" ng-disabled="! ctrl.experience.enable" title="multiple cases separated by a comma are accepted">
			</td><td ng-if="ctrl.wait"><span class="Loading">.</span> Collect in progress...</span>
			</td><td><button ng-click="ctrl.collectExperience( 'addCasesId' )" class="btn btn-info" ng-disabled="ctrl.wait || ! ctrl.experience.enable"">Collect Experience</button>
			</td><td style="padding-left: 20px"><button ng-click="ctrl.setAllVersionProcess()" class="btn btn-info btn-xs" ng-disabled="ctrl.wait || ! ctrl.experience.enable">Set all Process Version</button>
			</td><td style="padding-left: 20px"><button ng-click="ctrl.setAnonyseUser()" class="btn btn-info btn-xs" ng-disabled="ctrl.wait || ! ctrl.experience.enable">Set Anonymize users</button>
			</td>
			
			</tr>
		</table>		
		<div ng-bind-html="ctrl.getHtml( ctrl.experience.listevents )"></div>
										
					
		<!-- style="background-color: #f9f9f9;" -->
		<table class="table table-striped table-hover table-condensed">
			<tr>
				<th style="background-color: #f2dede; text-align: center;">Name</th>
				<th style="background-color: #f2dede; text-align: center;">Process</th>
				<th style="background-color: #f2dede; text-align: center;"><span title="number of robots ">Robots</span></th>
				<th style="background-color: #f2dede; text-align: center;"><span title="number of cases PER robots">Cases/rob</span></th>
				<th style="background-color: #f2dede; text-align: center;"><span ></span></th>
				<th style="background-color: #f2dede; text-align: center;"><span title="Time to sleep before the start">Delay start (ms)</span></th>
				<th style="background-color: #f2dede; text-align: center;"><span title="Time to sleep between each execution, in millisecond">sleep (ms)</span></th>
				<th style="background-color: #f2dede; text-align: center;"></th>
				<th style="background-color: #f2dede; text-align: center;"></th>
			</tr>
			<tbody ng-repeat="scenario in ctrl.experience.scenarii track by $index">
				<tr style="background-color: ##D9EDF7;border-width: 1px 1px" >
					<td style="background-color: #D9EDF7;border-width: 1px 1px"><span title="Name"><input ng-model="scenario.name" ng-disabled="! ctrl.experience.enable"></span></td>
							
					<td style="background-color: #D9EDF7;border-width: 1px 1px">
						<span title="Process name and version">{{scenario.processname}} ({{scenario.processversion}})</span>						
						<input type="checkbox" ng-model="scenario.allowrecentversion" title="If the version does not exist, use the last recent version">
						</td>
					<td style="background-color: #D9EDF7;border-width: 1px 1px;text-align: center;">
						<input type="number" ng-model="scenario.nbrobs" style="text-align: right; width: 80px;"
							title="The number of robot simulate multiple create IN PARRALLELE because robots runs undependably" ng-disabled="! ctrl.experience.enable"></td>
					<td style="background-color: #D9EDF7; text-align: center;">
						<input type="number" ng-model="scenario.nbcases" style="text-align: right; width: 80px;"	title="Attention, the number of case created will be Nb robots*nbCases" ng-disabled="! ctrl.experience.enable"></td>
					<td style="background-color: #D9EDF7; text-align: right;width: 80px">({{scenario.nbrobs*scenario.nbcases}})</td>
					<td style="background-color: #D9EDF7; text-align: center">
						<input type="number" ng-model="scenario.delaysleep" style="text-align: right; width: 80px;" title="Before start, robots will sleep this time (in ms)" ng-disabled="! ctrl.experience.enable"></td>
					<td style="background-color: #D9EDF7; text-align: center">
						<input type="number" ng-model="scenario.timesleep" style="text-align: right; width: 80px;" title="Between each execution, robots will sleep this time (in ms)" ng-disabled="! ctrl.experience.enable"></td>
					<td style="background-color: #D9EDF7; text-align: center">
						<a ng-click="scenario.showtimeline='show'" title="Access Details">
							<span class="glyphicon glyphicon-list-alt"></span>
						</a>
					</td>				
					<td style="background-color: #D9EDF7; text-align: center"><button ng-click="ctrl.removeExperience( scenario );" class="btn btn-danger btn-xs">Remove</button></td>
				</tr>
				<tr ng-if="scenario.showtimeline == 'show'">
					<td colspan="1">
					</td>
					<td colspan="8">
						<div style="box-shadow: 1px 1px 12px #555;">
							<div class="panel panel-info">
								<div class="panel-heading">
									<h5 class="panel-title">Details</h5>
									<div  style="position: relative; top: -25px; right: 0px; font-size: 18px; float:right"">
											<a  ng-click="scenario.showtimeline='hide'" >
											<span class="glyphicon glyphicon-remove" ></span>
											</a>
									</div>
								</div>
								<div class="panel-body">
								<table style="width:100%">
									<tr><th>Action</th><th>Time Line</th><th>Wait Before</th><th>User</th><th>Contract</th></tr>
									<tr>
										<td>Instantiation</td>
										<td></td>
										<td></td>
										<td class="align-text:right">{{scenario.usernamecreatedby}}<br>
											<input type="checkbox" ng-model="scenario.anyUserCreatedBy" title="Any user to create the case if this user does not exist"></td>
										<td>
										<textarea  cols="70" rows="5" ng-model="scenario.contract"  ng-disabled="true"></textarea>
										</td>
									</tr>
									<tr ng-repeat="timeline in scenario.timelines" ng-if="scenario.showtimeline == 'show'">
										<td >{{timeline.actname}}
											<div ng-if="timeline.actismultiinstanciation">
												<br> <div class="label label-default" title="This activity is a Multi Instance: so, search is based on the display name"><i>{{timeline.actdisplayname}}</i></div>
											</div>
										
										</td>
										<td class="align-text:right">{{timeline.timeLineFromBeginningMS_st}}</td>										
										<td class="align-text:right">
											<input type="number" ng-model="timeline.timewaitms" style="text-align: right; width: 80px;" title="Before executing this action, sleep this time (in ms)" ng-disabled="! ctrl.experience.enable">
										</td>
										<td class="align-text:right">{{timeline.executedby}}<br>
												<input type="checkbox" ng-model="timeline.anyUser" title="Any user if this user does not exist">
										</td>
										<td >
											<textarea cols="70" rows="5" ng-model="timeline.contract"  ng-disabled="true"></textarea>
										</td>
									</tr>
								</table>
									
									
									
								</div>
							</div>
						</div>
					
					</td>
				</tr>
			</tbody>
		</table>
		<p>
		<center>
			<button ng-click="ctrl.navbaractiv='execution';ctrl.start('classic')" class="btn btn-success" ng-disabled="ctrl.wait">Start</button>
		</center>
		
		

	</div> <!-- end experience -->
			
			
	<!--  ************************************************************  -->	
	<!--  Process        	 										-->
	<!--  ************************************************************  -->		
	<div class="col-xs-12" ng-if="ctrl.navbaractiv == 'processscenarii'">
		<p>
		<h2>Scenario {{ctrl.config.name}}</h2>
		<p>
		<div ng-if="ctrl.deploimentsuc.length >0 " class="alert alert-success">
			{{ctrl.deploimentsuc}}
		</div>
		
		<input type="checkbox" ng-model="ctrl.processes.enable" title="Enable Experience">Enable Process scenarii<p>
		<table width="100%">
			<tr>
				<td align="center"><span ng-show="ctrl.wait"> 
					<span class="Loading">.</span> Collect in progress...
					</span>
					
					<button id="collectbtn" ng-click="ctrl.collectProcesses()" class="btn btn-info" ng-disabled="ctrl.wait || ! ctrl.processes.enable">Collect Processes</button> {{ctrl.status}}

					<div ng-bind-html="ctrl.getHtml(ctrl.listeventslistprocesses )"></div></td>
				<td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
				<td width="900">
					
				</td>
			</tr>

		</table>
	
				
		<input type="checkbox" ng-model="ctrl.showonlyactive">Show only actives robot</input>
		<!-- style="background-color: #f9f9f9;" -->
		<table class="table table-striped table-hover table-condensed">
			<tr>
				<th style="background-color: #f2dede; text-align: center;">Name</th>
				<th style="background-color: #f2dede; text-align: center;"><span title="number or robots to start">Robots</span></th>
				<th style="background-color: #f2dede; text-align: center;" colspan="2"><span title="number of execution (cases or tasks) PER robots">exec/rob</span></th>
				<th style="background-color: #f2dede; text-align: center;"><span title="Time to sleep before the start">Delay start (ms)</span></th>
				<th style="background-color: #f2dede; text-align: center;"><span title="Time to sleep between each execution, in millisecond">sleep (ms)</span></th>
				<th style="background-color: #f2dede; text-align: center;">Contract</th>
			</tr>
			<tbody ng-repeat="processinfo in ctrl.processes.scenarii track by $index">
				<tr style="background-color: ##D9EDF7;border-width: 1px 1px" ng-show="! ctrl.showonlyactive  || processinfo.nbrob>0">
					<td style="background-color: #D9EDF7;border-width: 1px 1px"><span title="Process name and version">{{processinfo.information}}</span></td>
					<td style="background-color: #D9EDF7;border-width: 1px 1px;text-align: center;">
						<input type="number" ng-model="processinfo.nbrob" style="text-align: right; width: 80px;"
							title="The number of robot simulate multiple create IN PARRALLELE because robots runs undependably"
							ng-disabled="! ctrl.processes.enable"></td>
					<td style="background-color: #D9EDF7; text-align: center;">
						<input type="number" ng-model="processinfo.nbcases" style="text-align: right; width: 80px;"	
							title="Attention, the number of case created will be Nb robots*nbCases"
							ng-disabled="! ctrl.processes.enable"></td>
					<td style="background-color: #D9EDF7; text-align: right;width: 80px">({{processinfo.nbrob*processinfo.nbcases}})</td>
					<td style="background-color: #D9EDF7; text-align: center">
						<input type="number" ng-model="processinfo.delaysleep" style="text-align: right; width: 80px;" 
							title="Before start, robots will sleep this time (in ms)"
							ng-disabled="! ctrl.processes.enable"></td>
					<td style="background-color: #D9EDF7; text-align: center">
						<input type="number" ng-model="processinfo.timesleep" style="text-align: right; width: 80px;" 
							title="Between each creation, robots will sleep this time (in ms)"
							ng-disabled="! ctrl.processes.enable"></td>
					<td style="background-color: #D9EDF7; text-align: center;">
						<table>
							<tr ng-repeat="input in processinfo.inputs track by $index">
								<td>
									<input type="number" ng-model="input.percent" style="text-align: right; width: 80px;" ng-disabled="! ctrl.processes.enable">%
								</td>
								<td>
									<table>
										<tr><td>
											<button ng-click="ctrl.formatInput( processinfo, input)" class="btn btn-info btn-xs" style="width: 100%;" ng-disabled="! ctrl.processes.enable">Format</button>
										</td></tr>														
										<tr><td>
											<textarea cols="70" rows="5" ng-model="input.content" ng-disabled="! ctrl.processes.enable"></textarea>
										</td></tr>
										<tr><td>
											<button ng-click="ctrl.proposeInput( processinfo, input)" class="btn btn-default btn-xs" style="width: 100%;" ng-disabled="! ctrl.processes.enable">Propose</button>
										</td></tr>														
									</table>
								</td>
								<td>
									<button ng-click="ctrl.removeInput( processinfo, input) " class="btn btn-danger btn-xs" ng-disabled="! ctrl.processes.enable">Remove</button>
								</td>
							</tr>
						</table>
						<button ng-click="ctrl.addInput( processinfo )" class="btn btn-info btn-xs" ng-disabled="! ctrl.processes.enable">Add</button>
					</td>
				</tr>
				<tr ng-repeat="activityinfo in processinfo.activities track by $index"
					ng-show="! ctrl.showonlyactive  || activityinfo.nbrob>0" style="border-width: 1px 1px">
					<td style="background-color: #fcf8e3">&nbsp;&nbsp;{{activityinfo.activityname}}</td>
					<td style="background-color: #fcf8e3; text-align: center;">
						<input type="number"
							ng-model="activityinfo.nbrob" style="text-align: right; width: 80px;"
							ng-disabled="! ctrl.processes.enable"></td>
					<td style="background-color: #fcf8e3; text-align: center;">
						<input type="number"
						ng-model="activityinfo.nbcases" style="text-align: right; width: 80px;" ng-disabled="! ctrl.processes.enable"></td>
					<td style="background-color: #fcf8e3;text-align: right;width: 80px">({{activityinfo.nbrob*activityinfo.nbcases}})</td>										
					<td style="background-color: #fcf8e3; text-align: center;">
						<input type="number" ng-model="activityinfo.delaysleep" style="text-align: right; width: 80px;" ng-disabled="! ctrl.processes.enable"></td>
					<td style="background-color: #fcf8e3; text-align: center;">
						<input type="number" ng-model="activityinfo.timesleep" style="text-align: right; width: 80px;" ng-disabled="! ctrl.processes.enable"></td>
					<td style="background-color: #fcf8e3; text-align: center;; text-align: center">
						<table>
							<tr ng-repeat="input in activityinfo.inputs track by $index">
								<td>
									<input type="number" ng-model="input.percent" style="text-align: right; width: 80px;" ng-disabled="! ctrl.processes.enable">%
								</td>
								<td>
									<table>
										<tr><td>
											<textarea ng-model="input.content" ng-disabled="! ctrl.processes.enable"></textarea>
										</td></tr>
										<tr><td>
										<button ng-click="ctrl.proposeInput( activityinfo, input)" class="btn btn-default btn-xs" style="width: 100%;" ng-disabled="! ctrl.processes.enable">Propose</button>
										</td></tr>
									</table>

								</td>
								<td>
									<button ng-click="ctrl.removeInput( activityinfo, input) " class="btn btn-danger btn-xs" ng-disabled="! ctrl.processes.enable">Remove</button>
								</td>
							</tr>
						</table>
						<button ng-click="ctrl.addInput( activityinfo )" class="btn btn-info btn-xs" ng-disabled="! ctrl.processes.enable">Add</button>
					</td>
				</tr>
			</tbody>
		</table>
		
		<p>
		<center>
			<button ng-click="ctrl.navbaractiv='execution';ctrl.start('classic')" class="btn btn-success" ng-disabled="ctrl.wait">Start</button>
		</center>

		
	</div> <!-- end process -->

	<!--  ************************************************************  -->	
	<!--  Scenarii command    	 										-->
	<!--  ************************************************************  -->		
	
	<!-- 
			<div ng-show="ctrl.showscenarii">
					<table class="table table-striped table-hover table-condensed">
						<tr>
							<th style="background-color: #f2dede;text-align: center;">Name</th>
							<th style="background-color: #f2dede;text-align: center;">Type</th>
							<th style="background-color: #f2dede;text-align: center;">Robots</th>
							<th style="background-color: #f2dede;text-align: center;">Exec/rob</th>
							<th style="background-color: #f2dede;text-align: center;">Text</th>
							<th style="background-color: #f2dede;text-align: center;"></th>
						</tr>
						<tbody ng-repeat="scenarioinfo in ctrl.scenarii.actions track by $index">
							<tr>
								<td><input ng-model="scenarioinfo.name"></td>
								<td><select ng-model="scenarioinfo.type">
										<option value="GRV">Groovy</option>
										<option value="CMD">Command</option>
								</select></td>
								<td><input ng-model="scenarioinfo.nbrob" type="number" style="text-align: right; width: 80px;"></td>
								<td><input ng-model="scenarioinfo.nbexec" type="number" style="text-align: right; width: 80px;"></td>
								<td><textarea ng-model="scenarioinfo.scenario" rows="10" cols="80">  </textarea>
									<div ng-show="scenarioinfo.type=='CMD'">
										<br>
										 Append one verb:<br>
										<select ng-model="ctrl.scenarii.addsentence" style="width: 150px;" 
											ng-change="ctrl.appendsentence(scenarioinfo, ctrl.scenarii.addsentence)">
											<option ng-repeat="sentence in ctrl.configscenarii.cmd.sentences" value="{{sentence}}">{{sentence}}</option>
										</select>
										
									</div>
									<div ng-show="scenarioinfo.type=='GRV'">
										<br>
										 Append one line:<br>
										<select ng-model="ctrl.scenarii.addsentence" style="width: 150px;" 
											ng-change="ctrl.appendsentence(scenarioinfo, ctrl.scenarii.addsentence)">
											<option ng-repeat="sentence in ctrl.configscenarii.grv.sentences" value="{{sentence}}">{{sentence}}</option>
										</select>
										
									</div>

								</td>
								<td><button ng-click="ctrl.removeScenarii( scenarioinfo )" class="btn btn-danger">Remove</button></td>
							</tr>
						</tbody>
					</table>
					<center>
						<button ng-click="ctrl.addScenarii()" class="btn btn-info">Add</button>
					</center>
					
					
				</div> end ctrl.scenarii
			 -->
						
	<!--  ************************************************************  -->	
	<!--  Execution        	 										-->
	<!--  ************************************************************  -->		
	<div class="col-xs-12" ng-if="ctrl.navbaractiv == 'execution'">
		<p>
		<h2>Scenario {{ctrl.config.name}}</h2>
		<p>
		<div ng-if="ctrl.deploimentsuc.length >0 " class="alert alert-success">
			{{ctrl.deploimentsuc}}
		</div>
		
		<center>
			<button ng-click="ctrl.start('classic')" class="btn btn-success" ng-disabled="ctrl.wait">Start</button>
		</center>
		
		<span ng-show="ctrl.wait"> 
			<span class="Loading">.</span> {{ctrl.operation}} in progress {{ctrl.listUrlPercent}}%...<br>
				<div class="progress">
						<div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="{{ctrl.listUrlPercent}}" aria-valuemin="0" aria-valuemax="100" 
							style="width: {{ctrl.listUrlPercent}}%;"><span class="sr-only"></span>
						</div>
				</div>
		</span>	
		<br>
		<center>
			<div ng-bind-html="ctrl.getHtml( ctrl.execution.listeventsexecution )"></div>
		</center>

		<table class="table table-striped table-hover table-condensed">
			<tr>
				<th style="background-color: #99D9EA">Completion</th>
				<th style="background-color: #99D9EA">Robot</th>
				<th style="background-color: #99D9EA">State</th>
				<th style="background-color: #99D9EA">Nb errors</th>								
				<th style="background-color: #99D9EA">Advance</th>
				<th style="background-color: #99D9EA">Time(ms)</th>
				<th style="background-color: #99D9EA">Average(ms)</th>
				<th style="background-color: #99D9EA"></th>
			</tr>
			<tbody ng-repeat="robotinfo in ctrl.execution.robots track by $index">
				<tr> 
					<td style="{{ctrl.getRobotStyle( robotinfo )}}">
						<div class="progress">
							<div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="{{robotinfo.percent}}" aria-valuemin="0" aria-valuemax="100" 
								style="width: {{robotinfo.percentAdvance}}%;"><span class="sr-only">({{robotinfo.percentAdvance}}%)</span></div>
						</div>
						({{robotinfo.percentAdvance}}%)
					
					</td>
					<td style="{{ctrl.getRobotStyle( robotinfo )}}">{{robotinfo.title}}</td>
					<td style="{{ctrl.getRobotStyle( robotinfo )}}">{{robotinfo.status}}</td>
					<td style="{{ctrl.getRobotStyle( robotinfo )}}">{{robotinfo.nbErrors}}</td>
					<td style="{{ctrl.getRobotStyle( robotinfo )}}">{{robotinfo.adv}}</td>
					<td style="{{ctrl.getRobotStyle( robotinfo )}}">{{robotinfo.time}}</td>
					<td style="{{ctrl.getRobotStyle( robotinfo )}}">{{robotinfo.timeavg}}</td>
					<td style="{{ctrl.getRobotStyle( robotinfo )}}">
						<a ng-click="robotinfo.showlog='show'" title="Details">
							<span class="glyphicon glyphicon-list-alt"></span>
						</a>
					</td>	
						
				</tr>
				<tr ng-if="robotinfo.showlog == 'show'">
					<td></td>
					<td colspan="5">	
					<div style="box-shadow: 1px 1px 12px #555;">
						<div class="panel panel-info">
							<div class="panel-heading">
								<h5 class="panel-title">Details</h5>
								<div  style="position: relative; top: -25px; right: 0px; font-size: 18px; float:right"">
										<a  ng-click="robotinfo.showlog='hide'" >
										<span class="glyphicon glyphicon-remove" ></span>
										</a>
								</div>
							</div>
							<div class="panel-body">
								{{robotinfo.log}}		
							</div>
						</div> <!--  end panel info -->
					</div> <!--  end box shadow -->
					
					
										
							
					</td>
				</tr>
			</tbody>
		</table>

		<div class="well">
			<table width="100%">
				<tr><td>
					<table class="table ">
						<tr>
							<td>Simulation Id</td>
							<td>{{ctrl.simulationid}}</td>
						</tr>
						<tr>
							<td>Status</td>
							<td>{{ctrl.execution.status}}<br>
							<div ng-bind-html="ctrl.getHtml( ctrl.execution.listeventsexecution )"></div>
							
						</tr>
						<tr>
							<td>Time started:</td>
							<td>{{ctrl.execution.timeStarted}}</td>
						</tr>
						<tr>
							<td>Delay to finish (estimation)</td>
							<td>{{ctrl.execution.timeEstimatedDelay}}</td>
						</tr>
						<tr>
							<td>Time end (estimation)</td>
							<td>{{ctrl.execution.timeEstimatedEnd}}</td>
						</tr>
						<tr>
							<td>Time end</td>
							<td>{{ctrl.execution.timeEnded}}</td>
						</tr>								
						<tr>
							<td>Percent global</td>
							<td>{{ctrl.execution.percentAdvance}}%</td>
						</tr>
					</table>
				</td>
				<td  style="text-align: right;vertical-align: top;width:450px;">
				<!--  all simulations -->
					<table style=" border: 2px solid black;width:400px;">
						<th style="background-color: #f2dede; text-align: center;" colspan="5">Simulations in progress</th>
						<tr ng-repeat="simulation in ctrl.execution.listSimulations track by $index">
							
							<td style="text-align: center;">{{simulation.id}}</td>
							<td style="text-align: right;">{{simulation.percentAdvance}}%</td>
							<td style="text-align: right;">{{simulation.timeEstimatedEnd}}</td>
							<td style="text-align: right;">{{simulation.timeEstimatedDelay}}</td>
							<td> <button ng-click="ctrl.simulationid=simulation.id;ctrl.refresh()" class="btn btn-info btn-xs" ng-disabled="ctrl.refreshinprogress">Display</button></td>
						</tr>
					</table>
				</td>
				</tr>
			</table>
			<center>
				<span class="Loading" ng-show="ctrl.refreshinprogress">.</span> <button ng-click="ctrl.refresh()" class="btn btn-success" ng-disabled="ctrl.refreshinprogress">Refresh</button>
			</center>
		</div>
				
		<h3>Cover</h3>
		This section give the percent of each running scenario
		<table class="table table-striped table-hover table-condensed" width="100%">
			<tr>
				<th>Process</th>
				<th>General cover</th>
				<th>Happy path cover</th>
				<th>Error</th>
				<th>Activities not covered</th>
			</tr>	
			<tr ng-repeat="processinfo in ctrl.execution.cover track by $index">
				<td>{{processinfo.processname}} ({{processinfo.processversion}})</td>
				<td>{{processinfo.coverpercent}} %</td>
				<td>{{processinfo.coverhappypathpercent}} %</td>
				<td><div ng-bind-html="ctrl.getHtml( processinfo.listevents )"></div></td>
				<td>{{processinfo.activitiesnotcovered}}</td>
				
			</tr>
		</table>
		
				<!-- 
				Chart: {{processinfo.piechart}}<br>
					<div google-chart chart="{{processinfo.piechart}}"  style="height: 400px; width: 100%; position: relative; "></div>
					<div google-chart chart="{{processinfo.columChart}}"  style="height: 400px; width: 100%; position: relative; "></div>
					
				 -->
	</div> <!--  end execution -->
		
	<!--  ************************************************************  -->	
	<!--  Unit Test        	 										-->
	<!--  ************************************************************  -->		
	<div class="col-xs-12" ng-if="ctrl.navbaractiv == 'unittest'">
		<p>
		<h2>Scenario {{ctrl.config.name}}</h2>
		<p>
		<div ng-if="ctrl.deploimentsuc.length >0 " class="alert alert-success">
			{{ctrl.deploimentsuc}}
		</div>
		
		<center>
			<button ng-click="ctrl.navbaractiv='unittest';ctrl.start('unittest')" class="btn btn-success" ng-disabled="ctrl.wait">Unit Test</button>
		</center>
		
		<div ng-bind-html="ctrl.getHtml( ctrl.execution.listevents) "></div>
		
		<div style="text-align: right">
			Test passed with {{ctrl.execution.percentunittest}} %
		</div>
		<table  class="table table-striped table-hover table-condensed" width="100%">
			<tr>
				<th>Test</th>
				<th>Status</th>
			</tr>
			<tbody ng-repeat="robotinfo in ctrl.execution.robots track by $index">
				<tr> 
					<td>{{robotinfo.name}}</td>
					<td >
						<div ng-if="robotinfo.status === 'DONE'" class="label label-success">Success</div>
						<div ng-if="robotinfo.status !== 'DONE'">
							<div class="label label-danger">Error</div><br>
							<div ng-bind-html="ctrl.getHtml( robotinfo.explanationerror )"></div>
						</div>
					</td>
				</tr>
			</tbody>	
		</table>
		Unit test executed in {{ctrl.execution.timeinms}} ms
		
	</div> <!-- end unit test -->		
	<!--  ************************************************************  -->	
	<!--  Save        	 										-->
	<!--  ************************************************************  -->
	<!--  attention, do not use ng-if : with this tag, the drop down will not work -->		
	<div class="col-xs-12" ng-show="ctrl.navbaractiv == 'save'">
		<modal-dialog show='ctrl.isshowExportDialog' dialog-title='Export' width='75%' height='80%' 	close="ctrl.isshowExportDialog=false"> 
			<div class="modal-content" width='100%' height='100%'>
				<h2>Export configuration</h2>
				<p>
				<p>
				<table class="table">
					<tr>
					 
						<th><button ng-click="ctrl.selectAll(ctrl.config.list)" class="btn btn-info btn-xs">Select all</button>Configuration</th>
					</tr>
					<tr ng-repeat="oneconf in ctrl.config.list">
						<td><input type="checkbox" ng-model="oneconf.selected"></input>{{oneconf.name}}</td>
					</tr>
					</table>
				<p>
				<a class="btn btn-info" href="?page=custompage_meteor&action=exportconf&paramjson={{ctrl.getExportConfiguration()}}" >Export</a> 
			
			</div>
		</modal-dialog>
	
		<p>
		<h2>Scenario {{ctrl.config.name}}</h2>
		<p>
		<div ng-if="ctrl.deploimentsuc.length >0 " class="alert alert-success">
			{{ctrl.deploimentsuc}}
		</div>
		
		<div class="col-xs-6">
			Scenario name : <input ng-model="ctrl.config.newname" maxlength="30"/>
			<button ng-click="ctrl.saveConfig()" class="btn btn-success" ng-disabled="ctrl.wait">Save</button><br>
			<textarea ng-model="ctrl.config.newdescription" cols="50" rows="5"></textarea><br>
		</div>

		<div class="col-xs-6">
			List of Scenario:
			<select ng-model="ctrl.config.currentname" style="width: 150px;">
				<option ng-repeat="oneconf in ctrl.config.list" value="{{oneconf.name}}">{{oneconf.name}}</option>
			</select>
			<p>
			
			<button ng-click="ctrl.loadConfig('loadconfig')" class="btn btn-info" ng-disabled="meteor.config.list.length==0 || ctrl.wait">Load&nbsp;{{ctrl.config.currentname}}</button>
			<button ng-click="ctrl.navbaractiv='execution';ctrl.loadConfig('loadandstart')" class="btn btn-primary" ng-disabled="meteor.config.list.length==0 || ctrl.wait">Load And Start&nbsp;{{ctrl.config.currentname}}</button>
			<button ng-click="ctrl.deleteConfig()" class="btn btn-danger" ng-disabled="(! ctrl.config.currentname) || ctrl.wait">Delete&nbsp;{{ctrl.config.currentname}}</button></td>
			<p>

			<div ng-bind-html="ctrl.getHtml( ctrl.listeventsconfig )"></div>
			<p>
			
			<button ng-click="ctrl.isshowExportDialog=true" class="btn btn-primary" ng-disabled="meteor.config.list.length==0 || ctrl.wait">Export</button>													
			<div ng-file-drop ng-model="importfiles" class="drop-box ng-isolate-scope ng-valid ng-dirty"
						drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}"
						multiple="true" allow-dir="false">Drop your scenario (zip file) here</div>
			<div ng-no-file-drop class="drop-box" style="display: none;">File Drop is not supported for this browser</div>													
		</div>
		
		<span ng-show="ctrl.wait"> <span class="Loading">.</span> Operation in progress {{ctrl.listUrlPercent}}%...</span>
		
		<div class="col-xs-12">
			<h3>Automate tests</h3>
			To automate the test, first, load the scenario on your server.
			Then, you can execute it on-demand, via these different options:
			<li>use an external scheduler (Jenkins, Cron) and REST API</li>
			Using the REST API, you have first to log on to the server, via the Login Rest API.
			Second, call this REST API to start the execution:<br>
			Start:
			<div class="well">
				/bonita/portal/custom-page/custompage_meteor?page=custompage_meteor&amp;action=loadandstart&amp;scenario={{ctrl.config.newname}}
			</div>
			Status: (you have to wait the end of execution)<br>
			<div class="well">
				/bonita/portal/custom-page/custompage_meteor?page=custompage_meteor&amp;action=status&amp;simulationid=&lt;simulationId&gt;
			</div>
			
			
			<li>use an external scheduler and JAVA API</li>
			You have first to log on to the server via the JAVA API.
			Second, use the MeteorAPI
			<div class="well">
				import org.bonitasoft.meteor.MeteorClientAPI;<br>
				Map<String, Object> resultCommand = meteorClientAPI.startFromScenarioName(scenarioName, apiAccessor.getProcessAPI(), apiAccessor.getCommandAPI(), 1L /* Tenantid */);<br>
				<br>
				String simulationId = (String) resultCommand.get( CmdMeteor.cstParamResultSimulationId);<br>
				<br>
				if (simulationId!=null)<br>
				{<br>
				    /* you have to wait the end of execution */<br>
				    /* Check the status */<br>
        			Map<String, Object> resultStatus = meteorClientAPI.getStatus(statusParameters, apiAccessor.getProcessAPI(),  apiAccessor.getCommandAPI(), jobExecution.tenantId);<br>
            	    String statusSimulation = (String) resultStatus.get( MeteorSimulation.CSTJSON_STATUS);<br>
            		Integer percentAdvance = (Integer) resultStatus.get( MeteorSimulation.CSTJSON_PERCENTADVANCE );<br>
		            if (MeteorSimulation.STATUS.DONE.toString().equals( statusSimulation )) { <br>
		            	/** we are successfull */<br>
		            }<br>
              }<br>
			</div>

			<li>Use the TruckMilk plugin Meteor</li>
			Create a job, and gives the scenario name.

		</div>
		
	</div> <!--  end Save -->			
			

				

				
				
				
</div> <!--  end controler -->
	

	<!-- Third party dependencies -->

	<script src="3rd-party/jquery.min.js"></script>

	<script src="3rd-party/angular.min.js"></script>

	<script src="3rd-party/angular-resource.min.js"></script>
	<script src="3rd-party/angular-cookies.min.js"></script>

	<script src="3rd-party/bootstrap/js/bootstrap.min.js"></script>
	<script src="3rd-party/angular-bootstrap-tpls.min.js"></script>
	<script src="3rd-party/ng-google-chart.js"></script>
	<script src="3rd-party/angular-sanitize.min.js"></script>
	<script src="3rd-party/ng-modal.min.js"></script> 
	<script	src="3rd-party/angular-file-upload-shim.min.js"></script>
	<script	src="3rd-party/angular-file-upload.min.js"></script>


	<!-- Application dependencies -->
	<script src="meteormonitor.js?v=@_CURRENTTIMEMILIS_@"></script>
<!--			<script src="pageResource?page=custompage_meteor&location=meteormonitor.js&v=@_CURRENTTIMEMILIS_@"></script>  -->
</body>
</html>